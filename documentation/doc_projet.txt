"""
üìå Contexte du projet
Tu d√©veloppes un backend Django REST Framework (DRF) pour une application de p√¢tisserie.
L‚Äôobjectif est de g√©rer les recettes, les ingr√©dients, leurs prix, les moules, 
et de calculer les co√ªts et quantit√©s n√©cessaires en fonction des portions ou des moules utilis√©s.

‚úÖ Fonctionnalit√©s principales :
    - Gestion des ingr√©dients avec leurs cat√©gories et labels (+ plusieurs ajouts en une fois : bulk_create).
    - Gestion des recettes, y compris les sous-recettes et les √©tapes (+ possibilit√© de dupliquer une recette ; + archivage ; + favoris).
    - Recherche de recette par cat√©gorie, par label, par prix, par ingr√©dient, par temps de pr√©paration, etc.
    - Gestion des moules (pans) avec calcul de volumes pour ajuster les quantit√©s.
    - Calcul automatique des quantit√©s en fonction des servings, du moule utilis√© ou de quantit√©s sp√©cifiques d'un ou plusieurs ingr√©dient.
    - Calcul automatique du co√ªt d‚Äôune recette en fonction du prix des ingr√©dients (option : en fonction de quel magasin peuvent provenir les ingr√©dients).
    - Possibilit√© d'application collaborative pour remplir la base de donn√©es (le prix des ingr√©dients de diff√©rentes marques et dans les diff√©rents magasins).
    - Gestion de compte utilisateur et compte premium.
    - Tests automatis√©s (mod√®les, validation, API CRUD) avec pytest.

üìÇ Architecture du projet
1. Applications Django
    - pastry_app/ (application principale) Contient toute la logique m√©tier de l‚Äôapplication.
    - enchante/ (param√®tres du projet) Contient la configuration globale du projet (settings.py, urls.py, wsgi.py).

2 Principaux fichiers Django
Fichier	R√¥le
    models.py	D√©finition des mod√®les : Ingredient, Recipe, Pan, Category, Label‚Ä¶
    serializers.py	S√©rialisation des donn√©es pour Django REST Framework
    views.py	Logique m√©tier et endpoints API
    urls.py	Routes de l'API
    admin.py	Configuration de l‚Äôinterface d‚Äôadministration Django
    constants.py	Variables constantes utilis√©es dans l‚Äôapplication
    utils.py	Fonctions utilitaires (ex: calculs li√©s aux moules)
    tests/	 Dossier contenant tous les tests (mod√®le, validation, API/CRUD)
    settings.py	Configuration principale de Django
    populate_db.py	Script pour initialiser la base de donn√©es

üìä Mod√®les principaux
    1. Ingredient (Ingr√©dients) - Stocke les ingr√©dients et leurs cat√©gories / labels associ√©s.
        ingredient_name : Nom unique de l‚Äôingr√©dient (en lowercase)
        categories : ManyToMany avec Category (un ingr√©dient peut appartenir √† plusieurs cat√©gories).
        labels : ManyToMany avec Label (un ingr√©dient peut avoir plusieurs labels, ex: Bio, Vegan).
    2. Recipe (Recettes) - Stocke les informations principales d‚Äôune recette
        recipe_name : Nom unique de la recette
        chef : Nom du chef associ√© (otionnel)
        ingredients : Relation avec Ingredient
    3. RecipeIngredient (Association recette - ingr√©dients) - Associe des ingr√©dients √† une recette avec une quantit√© donn√©e.
        recipe : ForeignKey vers Recipe.
        ingredient : ForeignKey vers Ingredient.
        quantity : Quantit√© de l‚Äôingr√©dient requise pour cette recette.
        unit : Unit√© de mesure utilis√©e (grammes, litres, etc.).
    4. RecipeStep (√âtapes de la recette) - Stocke chaque √©tape de pr√©paration d‚Äôune recette.
        recipe : ForeignKey vers Recipe.
        step_number : Num√©ro de l‚Äô√©tape (permet de garder l‚Äôordre).
        description : D√©tail de l‚Äô√©tape de pr√©paration.
    5. SubRecipe (Recette dans une autre recette) - G√®re les recettes qui sont des sous-recettes d‚Äôune autre recette.
        main_recipe : ForeignKey vers la recette principale.
        sub_recipe : ForeignKey vers une autre Recipe (qui est une sous-recette).
        quantity : Quantit√© de la sous-recette utilis√©e dans la recette principale.
    6. IngredientPrice (Prix des ingr√©dients par magasin) - Stocke le prix des ingr√©dients selon le magasin.
        ingredient : ForeignKey vers Ingredient (chaque prix est li√© √† un ingr√©dient pr√©cis).
        store : Nom du magasin o√π le prix est applicable.
        price : Prix de l‚Äôingr√©dient dans ce magasin.
    7. Category (Cat√©gories d‚Äôingr√©dients et de recettes) - Classement des ingr√©dients et des recettes.
        category_name : Nom unique de la cat√©gorie.
        Relation ManyToMany avec Ingredient et Recipe (un ingr√©dient ou une recette peut avoir plusieurs cat√©gories).
    8. Label (Labels alimentaires et certifications) - Classement par label (ex: Bio, Vegan, AOC, etc.).
        label_name : Nom unique du label.
        Relation ManyToMany avec Ingredient et Recipe (un ingr√©dient ou une recette peut avoir plusieurs labels).
    9. Pan (Moules) - G√®re les diff√©rents types de moules avec calcul de volume
        pan_name : Nom unique du moule
        pan_type : Type (round, square, custom)
    10. Mod√®les sp√©cifiques pour chaque type de moule
        RoundPan (Moule rond) - Mod√®le pour un moule circulaire.
            diameter : Diam√®tre du moule.
            height : Hauteur du moule.
        SquarePan (Moule carr√© ou rectangulaire) - Mod√®le pour un moule rectangulaire ou carr√©.
            width : Largeur du moule.
            length : Longueur du moule.
            height : Hauteur du moule.
        CustomPan (Moule personnalis√©) - Mod√®le pour un moule de forme non standard.
            volume : Volume total du moule, d√©fini par l‚Äôutilisateur.

üìå Tests mis en place
Organisation des tests :

tests/
‚îÇ‚îÄ‚îÄ models/  ‚Üí Tests des mod√®les (`test_category_model.py`, `test_ingredient_model.py`, etc.)
‚îÇ‚îÄ‚îÄ validation/  ‚Üí Tests de validation m√©tier (`test_category_validation.py`, `test_recipe_validation.py`, etc.)
‚îÇ‚îÄ‚îÄ crud/  ‚Üí Tests CRUD via API (`test_category.py`, `test_ingredient.py`, etc.)
‚îÇ‚îÄ‚îÄ base_api_test.py  ‚Üí Classe `BaseAPITest` pour factoriser les tests API

Tests r√©alis√©s :

Type de test     | Fichier concern√©	                                            | Ce qui est test√©
Tests mod√®les    |	test_category_model.py, test_ingredient_model.py            |  Cr√©ation, suppression, __str__(), unicit√©‚Ä¶
Tests validation |	test_category_validation.py, test_ingredient_validation.py  |  full_clean(), contraintes (blank=False, unique=True)
Tests API (CRUD) |	test_category.py, test_ingredient.py                        |  Cr√©ation, modification, suppression via l‚ÄôAPI

"""